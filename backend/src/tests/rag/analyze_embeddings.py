import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ src –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', '..'))

from ml.rag_bot import EmbeddingsService

print("üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º embeddings –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ–∏—Å–∫–∞...")

embeddings = EmbeddingsService()

# –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã
query = "–ñ–∏–≤–æ—Ç–Ω–æ–µ –∏–∑–¥–∞–µ—Ç –∑–≤—É–∫–∏"
doc1 = "–°–æ–±–∞–∫–∞ –ª–∞–µ—Ç –Ω–∞ —É–ª–∏—Ü–µ"  # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
doc2 = "–ö–æ—Ç —Å–ø–∏—Ç –Ω–∞ –¥–∏–≤–∞–Ω–µ"    # –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
doc3 = "–ü—Ç–∏—Ü–∞ –ø–æ–µ—Ç –≤ —Å–∞–¥—É"     # –¢–æ–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

print(f"üéØ –ó–∞–ø—Ä–æ—Å: '{query}'")
print()

# –°—á–∏—Ç–∞–µ–º similarity –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
docs = [doc1, doc2, doc3]
similarities = []

for doc in docs:
    sim = embeddings.similarity(query, doc)
    similarities.append(sim)
    print(f"üìÑ '{doc}' -> similarity: {sim:.3f}")

print()
print("üß† –ê–Ω–∞–ª–∏–∑:")
print("1. –ú–æ–¥–µ–ª—å all-MiniLM-L6-v2 –æ–±—É—á–µ–Ω–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ")
print("2. –†—É—Å—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Ç–æ–∫–µ–Ω—ã")
print("3. '–ñ–∏–≤–æ—Ç–Ω–æ–µ' –∏ '–∫–æ—Ç' –º–æ–≥—É—Ç –±—ã—Ç—å –±–ª–∏–∑–∫–∏ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ")
print("4. '–∏–∑–¥–∞–µ—Ç –∑–≤—É–∫–∏' –∏ '—Å–ø–∏—Ç' - —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∏—Ö –ø—É—Ç–∞—Ç—å")

print()
print("üí° –†–µ—à–µ–Ω–∏—è:")
print("1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä—É—Å—Å–∫—É—é –º–æ–¥–µ–ª—å: 'cointegrated/rubert-tiny2'")
print("2. –£–ª—É—á—à–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é")
print("3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å threshold –¥–ª—è similarity")
print("4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –º–æ–¥–µ–ª—å embeddings")